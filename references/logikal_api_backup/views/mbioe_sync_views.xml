<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Master Sync List View -->
    <record id="view_mbioe_master_sync_list" model="ir.ui.view">
        <field name="name">mbioe.master.sync.list</field>
        <field name="model">mbioe.master.sync</field>
        <field name="arch" type="xml">
            <list>
                <field name="name"/>
                <field name="sync_type"/>
                <field name="state" widget="badge" 
                       decoration-success="state == 'completed'"
                       decoration-warning="state == 'running'"
                       decoration-danger="state == 'failed'"/>
                <field name="master_job_status" widget="badge" 
                       decoration-success="master_job_status == 'done'"
                       decoration-warning="master_job_status in ('pending', 'started')"
                       decoration-danger="master_job_status == 'failed'"/>
                <field name="total_folders"/>
                <field name="completed_folders"/>
                <field name="progress_percentage" widget="progressbar"/>
                <field name="start_time"/>
                <field name="estimated_completion"/>
                <field name="duration"/>
            </list>
        </field>
    </record>

    <!-- Master Sync Form View -->
    <record id="view_mbioe_master_sync_form" model="ir.ui.view">
        <field name="name">mbioe.master.sync.form</field>
        <field name="model">mbioe.master.sync</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_start_sync" string="Start Sync" 
                            type="object" invisible="state not in ('draft', 'queued')"
                            class="oe_highlight"/>
                    <button name="action_cancel_sync" string="Cancel Sync" 
                            type="object" invisible="state not in ('queued', 'running')"
                            class="oe_warning"/>
                    <button name="action_retry_failed" string="Retry Failed" 
                            type="object" invisible="state not in ('failed', 'completed')"
                            class="oe_warning"/>
                    <field name="state" widget="statusbar"/>
                </header>
                
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Sync Name"/>
                        </h1>
                    </div>
                    
                    <!-- Progress Section -->
                    <group>
                        <group string="Progress">
                            <field name="total_folders"/>
                            <field name="completed_folders"/>
                            <field name="running_folders"/>
                            <field name="failed_folders"/>
                            <field name="pending_folders"/>
                        </group>
                        <group string="Timing">
                            <field name="start_time"/>
                            <field name="estimated_completion"/>
                            <field name="end_time"/>
                        </group>
                    </group>
                    
                    <!-- Job Tracking -->
                    <group string="Job Tracking">
                        <field name="master_job_uuid" readonly="1"/>
                        <field name="master_job_status" widget="badge" 
                               decoration-success="master_job_status == 'done'"
                               decoration-warning="master_job_status in ('pending', 'started')"
                               decoration-danger="master_job_status == 'failed'"/>
                    </group>
                    
                    <!-- Progress Bar -->
                    <div class="oe_progress">
                        <field name="progress_percentage" widget="progressbar"/>
                        <span>Progress: <field name="progress_percentage"/>%</span>
                    </div>
                    
                    <!-- Results Summary -->
                    <group string="Results">
                        <field name="total_projects"/>
                        <field name="total_phases"/>
                        <field name="total_elevations"/>
                        <field name="error_count"/>
                    </group>
                    
                    <!-- Error Summary -->
                    <notebook>
                        <page string="Error Summary" invisible="error_count == 0">
                            <field name="error_summary"/>
                        </page>
                        <page string="Folder Jobs">
                            <field name="folder_job_ids">
                                <list>
                                    <field name="folder_id"/>
                                    <field name="sync_status"/>
                                    <field name="total_projects"/>
                                    <field name="phases_created"/>
                                    <field name="phases_updated"/>
                                    <field name="error_message"/>
                                    <field name="duration"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Master Sync Search View -->
    <record id="view_mbioe_master_sync_search" model="ir.ui.view">
        <field name="name">mbioe.master.sync.search</field>
        <field name="model">mbioe.master.sync</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="sync_type"/>
                <field name="state"/>
                <filter name="state_draft" string="Draft" domain="[('state', '=', 'draft')]"/>
                <filter name="state_running" string="Running" domain="[('state', '=', 'running')]"/>
                <filter name="state_completed" string="Completed" domain="[('state', '=', 'completed')]"/>
                <filter name="state_failed" string="Failed" domain="[('state', '=', 'failed')]"/>
                <group expand="0" string="Group By">
                    <filter name="group_sync_type" string="Sync Type" context="{'group_by': 'sync_type'}"/>
                    <filter name="group_state" string="State" context="{'group_by': 'state'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Folder Sync List View -->
    <record id="view_mbioe_folder_sync_list" model="ir.ui.view">
        <field name="name">mbioe.folder.sync.list</field>
        <field name="model">mbioe.folder.sync</field>
        <field name="arch" type="xml">
            <list>
                <field name="folder_id"/>
                <field name="master_sync_id"/>
                <field name="sync_status" widget="badge"
                       decoration-success="sync_status == 'completed'"
                       decoration-warning="sync_status == 'in_progress'"
                       decoration-danger="sync_status == 'failed'"/>
                <field name="total_projects"/>
                <field name="completed_projects"/>
                <field name="phases_created"/>
                <field name="elevations_created"/>
                <field name="start_time"/>
                <field name="duration"/>
                <field name="error_message"/>
            </list>
        </field>
    </record>

    <!-- Folder Sync Form View -->
    <record id="view_mbioe_folder_sync_form" model="ir.ui.view">
        <field name="name">mbioe.folder.sync.form</field>
        <field name="model">mbioe.folder.sync</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group string="Folder Information">
                            <field name="folder_id"/>
                            <field name="master_sync_id"/>
                            <field name="sync_type"/>
                        </group>
                        <group string="Sync Status">
                            <field name="sync_status"/>
                            <field name="total_projects"/>
                            <field name="completed_projects"/>
                            <field name="current_project"/>
                        </group>
                    </group>
                    
                    <group string="Results">
                        <group string="Phases">
                            <field name="phases_created"/>
                            <field name="phases_updated"/>
                            <field name="phases_deleted"/>
                        </group>
                        <group string="Elevations">
                            <field name="elevations_created"/>
                            <field name="elevations_updated"/>
                            <field name="elevations_deleted"/>
                        </group>
                    </group>
                    
                    <group string="Timing">
                        <field name="start_time"/>
                        <field name="end_time"/>
                        <field name="duration"/>
                    </group>
                    
                    <group string="Error Information" invisible="not error_message">
                        <field name="error_message"/>
                        <field name="retry_count"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

</odoo>
